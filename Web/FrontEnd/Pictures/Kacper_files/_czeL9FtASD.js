if (self.CavalryLogger) { CavalryLogger.start_js(["p2gVc"]); }

__d("CurationCaretNux",["csx","cx","Arbiter","AsyncRequest","CSS","DataStore","DOM","Event","NavigationMessage","Parent","Rect","ge","tidyEvent"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i="div._1zpr",j="div._6ks",k="._3x-2 img.img",l="span.text_exposed_link",m="_5jmm",n="CurationCaretNux_instance",o="CurationCaretNux_caretMenuLoaded",p=100,q="LINK_WELCOME",r="VIDEO_WELCOME",s="POST_SAVE_WELCOME",t="PHOTO_WELCOME",u="caret_nux",v="save_option_nux",w="seen",x="dismissed",y="focus",z="click",A="scroll",B=!1,C=null,D=null;function a(a,c,d,e,f,g){"use strict";__p&&__p();e=b("ge")(e);if(e){this.container=e;this.caret=d;this.caretNux=a.instance;this.caretNuxData=a;this.saveOptionNux=c.instance;this.saveOptionNuxData=c;this.allowAutoplayNux=g;this.popoverTriggered=!1;d=b("Parent").byClass(e,m);b("DataStore").set(d,n,this);switch(f){case q:this.$1();break;case r:this.$1();this.$2();this.$3();break;case s:this.$4();break;case t:this.$5();break}b("Arbiter").subscribeOnce(b("NavigationMessage").NAVIGATION_BEGIN,function(){this.caretNux&&this.caretNux.hide(),this.saveOptionNux&&this.saveOptionNux.hide()}.bind(this))}}a.prototype.$1=function(){"use strict";__p&&__p();var a=b("DOM").scry(this.container,i);a.length>0&&b("tidyEvent")([b("Event").listen(a[0],"click",function(){__p&&__p();if(B||this.videoPlaying)return;this.caretNux.subscribe("show",function(){this.$6()}.bind(this));this.caretNux.subscribe("hide",function(){this.$7(),B&&(this.$8(u,w),this.$8(u,x))}.bind(this));this.$9();this.interactionTime=0;window.setTimeout(function(){this.$10()||(B=!0,this.caretNux.show())}.bind(this),this.caretNuxData.min_consume_duration);window.setTimeout(function(){this.$10()||(B=!1,this.caretNux.hide())}.bind(this),this.caretNuxData.max_consume_duration);var a=Date.now();window.setTimeout(function(){this.$11(function(){this.interactionTime||(this.interactionTime=Date.now()-a)}.bind(this))}.bind(this),0)}.bind(this))])};a.prototype.$2=function(){"use strict";var a=b("DOM").scry(this.container,j);a.length>0&&b("tidyEvent")([b("Event").listen(a[0],"click",function(){this.videoPlaying=!0}.bind(this))])};a.prototype.$3=function(){"use strict";__p&&__p();if(!this.allowAutoplayNux)return;D===null&&(D=this.caretNuxData.min_consume_duration);C===null&&!B&&(C=b("Arbiter").subscribe("flash/updateStatus",function(a,c){if(!B&&D!==null&&c.position*1e3>D){a=b("Parent").byClass(b("ge")(c.divID),m);c=b("DataStore").get(a,n);c&&(B=!0,c.caretNux.show(),c.$6(),b("Arbiter").unsubscribe(C))}}))};a.prototype.$4=function(){"use strict";var a=b("DOM").scry(this.container,l);a.length>0&&b("tidyEvent")([b("Event").listen(a[0],"click",function(){if(B)return;B=!0;this.caretNux.show();this.$6()}.bind(this))])};a.prototype.$5=function(){"use strict";__p&&__p();var a=b("DOM").scry(this.container,k);a.forEach(function(a){__p&&__p();a=b("Parent").byTag(a,"a");if(!a)return;b("Event").listen(a,"click",function(){if(B)return;var a=b("Arbiter").subscribe("PhotoSnowlift.OPEN",function(){var c=Date.now(),d=b("Arbiter").subscribe("PhotoSnowlift.CLOSE",function(){var a=Date.now()-c;a>this.caretNuxData.min_consume_duration&&a<this.caretNuxData.max_consume_duration&&(B=!0,this.caretNux.show(),this.$6());b("Arbiter").unsubscribe(d)}.bind(this));b("Arbiter").unsubscribe(a)}.bind(this))}.bind(this))},this)};a.prototype.$10=function(){"use strict";return this.interactionTime&&this.interactionTime>0};a.prototype.$6=function(){"use strict";__p&&__p();this.caretClickListener=b("Event").listen(this.caret,"click",function(){this.caretNux.hide(),this.saveOptionNux&&(this.popoverTriggered=!0,this.$12())}.bind(this));var a=!1,c=function(c){if(a||c===z||!this.caretNux.isShown())return;c=b("Rect").getViewportWithoutScrollbarsBounds();var d=b("Rect").getElementBounds(this.caretNux.getContentRoot());d=d.sub(0,p);c.contains(d)&&(this.$8(u,w),a=!0)}.bind(this);c();this.$9();this.$11(c)};a.prototype.$7=function(){"use strict";this.caretClickListener.remove(),this.$13()};a.prototype.$12=function(){"use strict";__p&&__p();this.$14()&&this.popoverTriggered&&window.setTimeout(function(){__p&&__p();var a=b("DOM").scry(document,"li.save_caret_menu_item");for(var c=0;c<a.length;c++){var d=a[c],e=b("Parent").byClass(d,"uiLayer");if(e&&b("CSS").shown(e)){this.saveOptionNux.setContext(d);break}}this.saveOptionNux.show();this.$8(v,w);e=b("DataStore").get(this.caret,"Popover");e&&e.subscribeOnce("hide",function(){this.saveOptionNux.hide()}.bind(this))}.bind(this),0)};a.prototype.$8=function(a,c){"use strict";__p&&__p();var d;if(a===u)d=this.caretNuxData;else if(a===v)d=this.saveOptionNuxData;else throw new Error("Invalid nux type");var e;if(c===w)e=d.seen_uri,d.seen_uri=null;else if(c===x)e=d.dismiss_uri,d.dismiss_uri=null;else throw new Error("Invalid impression type");if(e){c=new(b("AsyncRequest"))(e);this.interactionTime&&a===u&&c.setData({interaction_time:this.interactionTime});c.send()}};a.prototype.$11=function(a){"use strict";this.$15.push(a)};a.prototype.$16=function(a){"use strict";this.$15.forEach(function(b){b.call(this,a)},this)};a.prototype.$9=function(){"use strict";this.$17||(this.$15=[],this.$17=[b("Event").listen(window,"click",this.$16.bind(this,z)),b("Event").listen(window,"focus",this.$16.bind(this,y)),b("Event").listen(window,"scroll",this.$16.bind(this,A))])};a.prototype.$13=function(a){"use strict";if(this.$17){while(this.$17.length)this.$17.pop().remove();this.$17=null;this.$15=null}};a.prototype.$14=function(){"use strict";var a=b("Parent").byClass(this.container,m);return b("DataStore").get(a,o)===!0};a.saveOptionLoaded=function(a){"use strict";__p&&__p();a=b("ge")(a);if(a){a=b("Parent").byClass(a,m);if(a){b("DataStore").set(a,o,!0);a=b("DataStore").get(a,n);a&&a.$12()}}};e.exports=a}),null);
__d("TimelineInHouseAppCollections",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FRIENDS_RECENT:1,FRIENDS_ALL:2,FRIENDS_MUTUAL:3,PHOTOS_OF:4,PHOTOS_ALL:5,PHOTOS_ALBUMS:6,INFO_ALL:8,MUSIC_FAVS:10,BOOKS_READ:14,BOOKS_FAVORITE:15,FITNESS_OVERVIEW:20,INFO_CONTACT:29,FITNESS_RUNNING:30,FITNESS_CYCLING:31,FRIENDS_FOLLOWERS:32,FRIENDS_FOLLOWING:33,INFO_HISTORY:35,PHOTOS_ARCHIVE:38,NOTES_MY_NOTES:39,NOTES_DRAFTS:40,NOTES_ABOUT_ME:41,VIDEO_MOVIES_WATCH:46,VIDEO_TV_SHOWS_WATCH:47,VIDEO_MOVIES_FAVORITE:52,VIDEO_TV_SHOWS_FAVORITE:53,FRIENDS_HIGH_SCHOOL:54,FRIENDS_COLLEGE:55,FRIENDS_WORK:56,APPS_LIKE:58,UPCOMING_EVENTS:59,PAST_EVENTS:60,LIKES_PEOPLE:61,GROUPS_MEMBER:66,PHOTOS_ALBUM:69,LIKES_RESTAURANTS:73,SAVED_BOOKS:87,SAVED_MOVIES:88,SAVED_TV_SHOWS:89,SAVED_MUSIC:90,SAVED_LINKS:92,SPORTS_TEAMS:95,LIKES_ALL:96,SAVED_PLACES:97,SAVED_ALL:98,SPORTS_ATHLETES:99,SAVED_EVENTS:101,SAVED_ARCHIVED:102,PLACES_RECENT:103,PLACES_VISITED:104,REVIEWS_WRITTEN:105,LIKES_SECTION_MOVIES:106,LIKES_SECTION_TV_SHOWS:107,LIKES_SECTION_BOOKS:108,LIKES_SECTION_MUSIC:109,LIKES_SECTION_SPORTS_TEAMS:110,PLACES_CITIES:112,PLACE_VISITS_BY_CITY:113,PLACES_MAP:117,LIKES_SECTION_APPS_AND_GAMES:118,LIKES_SECTION_SPORTS_ATHLETES:119,SAVED_VIDEOS:121,SAVED_PAGES:122,FRIENDS_WITH_UPCOMING_BIRTHDAYS:123,FRIENDS_CURRENT_CITY:124,FRIENDS_HOMETOWN:125,AT_WORK_CONTACT:127,PLACE_REVIEWS_WRITTEN:128,MOVIE_REVIEWS_WRITTEN:129,TV_SHOW_REVIEWS_WRITTEN:130,BOOK_REVIEWS_WRITTEN:131,VIDEOS_BY_USER:133,VIDEOS_USER_TAGGED:134,SAVED_POSTS:138,SAVED_PHOTO_POSTS:139,SAVED_PRODUCTS:140,AT_WORK_HR_INFO:141,FRIENDS_WITH_UNSEEN_POSTS:142,GROUPS_MUTUAL:143,SAVED_PROFILES:144,WORK_FOLLOWERS:149,WORK_FOLLOWING:150,SAVED_MESSAGES:151,SAVED_LISTS:152,SAVED_FUNDRAISERS:153,SAVED_JOBS:155,LISTS:156,LIST_CONTENTS:157,SAVED_GROUP_POSTS:158,SAVED_OFFERS:159,FUN_FACT_ANSWERS:164,SAVED_ASSET3DS:167,SAVED_MARKETPLACE_NEARBUY_DEALS:170,STORIES_ARCHIVE:175,WORK_BOOKMARKED_COWORKERS:176,PROFILE_SONGS:200,INSTAGRAM_RECENT_PHOTOS_COLLECTION_ID:486228154733719,POKEDEX_RECENTLY_CAUGHT_COLLECTION_ID:293429474107238,POKEDEX_TOP_CATCHES_COLLECTION_ID:298330700283782,UNKNOWN_DO_NOT_USE_THIS:0})}),null);