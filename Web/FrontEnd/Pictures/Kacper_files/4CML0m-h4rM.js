if (self.CavalryLogger) { CavalryLogger.start_js(["Ozur7"]); }

__d("FeedStoryCategory",[],(function(a,b,c,d,e,f){e.exports={UNKNOWN:0,ORGANIC:1,ENGAGEMENT:2,FIXED_POSITION:3,PROMOTION:4,SPONSORED:5,END_OF_FEED_CONTENT:6,FB_STORIES:7,HIGH_VALUE_PROMOTION:8}}),null);
__d("FeedLoadEventWWWLogger",["Arbiter","BanzaiLogger","ErrorSignal","ErrorUtils","LitestandMessages","PageletEventConstsJS","URI"],(function(a,b,c,d,e,f){__p&&__p();var g=["substream_","more_pager_pagelet_","pagelet_composer","pagelet_navigation","pagelet_rhc_footer"],h=[b("PageletEventConstsJS").ARRIVE_END,b("PageletEventConstsJS").DISPLAY_END,b("PageletEventConstsJS").ONLOAD_END],i=["pre_page_transition","page_transition"],j=[b("LitestandMessages").NEWSFEED_LOAD,b("LitestandMessages").STORIES_REQUESTED,b("LitestandMessages").STORIES_INSERTED,b("LitestandMessages").NEWER_STORIES_REQUESTED,b("LitestandMessages").NEWER_STORIES_INSERTED,b("LitestandMessages").STREAM_LOAD_ERROR,b("LitestandMessages").STREAM_LOAD_RETRY,b("LitestandMessages").DUPLICATE_CURSOR_ERROR],k=!1;function l(a){return a&&(a.getPath()==="/"||a.getPath()==="/home.php")}function m(a){b("BanzaiLogger").log("WebFeedLoadLoggerConfig",a)}function n(a){if(!a)return null;if(a.indexOf("more_pager_pagelet_")===0)return"more_pager_pagelet_n";return a.indexOf("substream_")===0&&a!=="substream_0"&&a!=="substream_1"?"substream_n":a}a={init:function(){__p&&__p();if(k)return;b("Arbiter").subscribe("BigPipe/init",function(a,c){if(!c||!c.arbiter)return;c.arbiter.subscribe("pagelet_event",function(a,c){c&&h.indexOf(c.event)>=0&&g.some(function(a){return c.id.indexOf(a)===0})&&l(b("URI").getNextURI())&&m({event:"pagelet",pagelet_id:n(c.id),pagelet_event_type:c.event,pagelet_phase:c.phase.toString()})})});b("Arbiter").subscribe(i,function(a,b){if(b){b=b.to||b.uri;l(b)&&m({event:"page_transition",transition_event_type:a})}});b("Arbiter").subscribe(j,function(a,c){var d=null,e=null;a===b("LitestandMessages").STREAM_LOAD_ERROR?d=c:a===b("LitestandMessages").DUPLICATE_CURSOR_ERROR&&(e=c);m({event:"stream_load",stream_event_type:a,stream_cursor:e,stream_substream_id:n(c&&c.substream_id),error_name:d&&d.name,error_message:d&&d.message,error_stack:d&&d.stack})});b("ErrorUtils").addListener(function(a){a&&l(b("URI").getNextURI())&&m({event:"js_error",error_name:a.name,error_message:a.message,error_stack:a.stack})});k=!0}};e.exports=a}),null);
__d("AdAllocationIntegrityGapsInfo",["FeedStoryCategory"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this.story_category=a,this.dist_to_top=-1,this.dist_to_fixed=-1,this.dist_to_promo=-1,this.dist_to_sponsored=-1,this.dist_to_engagement=-1}a.prototype.setDistToTop=function(a){"use strict";this.dist_to_top=a};a.prototype.setDistIfAbsent=function(a,c){"use strict";__p&&__p();if(c<0||a===b("FeedStoryCategory").UNKNOWN||a===b("FeedStoryCategory").ORGANIC)return;switch(a){case b("FeedStoryCategory").ENGAGEMENT:this.dist_to_engagement=this.$1(c,this.dist_to_engagement);break;case b("FeedStoryCategory").FIXED_POSITION:this.dist_to_fixed=this.$1(c,this.dist_to_fixed);break;case b("FeedStoryCategory").PROMOTION:this.dist_to_promo=this.$1(c,this.dist_to_promo);break;case b("FeedStoryCategory").SPONSORED:this.dist_to_sponsored=this.$1(c,this.dist_to_sponsored);break}};a.prototype.$1=function(a,b){"use strict";return b===-1?a:b};e.exports=a}),null);
__d("AdAllocationIntegrityUtils",["DataAttributeUtils","FeedStoryCategory","collectDataAttributes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="data-story_category",h="data-dedupekey",i="ft";a={getFeedStoryCategory:function(a){__p&&__p();var c=b("collectDataAttributes")(a,[i]).ft;a=b("DataAttributeUtils").getDataAttribute(a,g);if(a)switch(a){case"2":return b("FeedStoryCategory").ENGAGEMENT;case"3":return b("FeedStoryCategory").FIXED_POSITION;case"4":return b("FeedStoryCategory").PROMOTION;default:return b("FeedStoryCategory").UNKNOWN}else if(c.ei)return b("FeedStoryCategory").SPONSORED;else return b("FeedStoryCategory").ORGANIC},isGapRuleCategory:function(a){if(a===b("FeedStoryCategory").SPONSORED||a===b("FeedStoryCategory").ENGAGEMENT||a===b("FeedStoryCategory").FIXED_POSITION||a===b("FeedStoryCategory").PROMOTION)return!0;else return!1},getDedupKey:function(a){return b("DataAttributeUtils").getDataAttribute(a,h)}};e.exports=a}),null);
__d("ViewportTrackingHooks",["Base64"],(function(a,b,c,d,e,f){__p&&__p();var g={},h=[];a={registerFeedObject:function(a,c){g[a]=b("Base64").encode(c)},updateVisibleViewportObjects:function(a){var b=[],c=!1;for(var d=0;d<a.length;d++){var e=a[d],f=e.id;while(!(f in g)&&e.firstChild!=void 0&&e.firstChild.id!=void 0&&e.firstChild.id.startsWith("u_"))f=e.firstChild.id,e=e.firstChild;f in g&&(b.push(g[f]),(!(d in h)||h[d]!=g[f])&&(c=!0))}!c&&h.length!=b.length&&(c=!0);c&&(h=b,typeof __EXT__updateVisibleViewportObjects==="function"&&__EXT__updateVisibleViewportObjects(h))}};e.exports=a}),null);
__d("viewportTrackingBuilder",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b=null;return{factory:a,singleton:function(){b||(b=a.apply(void 0,arguments));return b},clearSingleton:function(){b=null}}};e.exports=a}),null);
__d("ViewportTracking",["cx","invariant","AdAllocationIntegrityGapsInfo","AdAllocationIntegrityUtils","Arbiter","Banzai","BanzaiScuba","CSS","CurrentUser","DOM","DOMDimensions","Event","LitestandMessages","NavigationMessage","Run","SubscriptionsHandler","TimeSlice","UserActivity","ViewportTrackingHelper","ViewportTrackingHooks","clearTimeout","clickRefAction","collectDataAttributes","debounce","getElementPosition","getViewportDimensions","pageID","setTimeout","throttle","viewportTrackingBuilder"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=97,j="vpv",k=3,l=2,m=1,n=0,o=1,p=2,q=3,r=4;function s(a){this.cachedAllStories=[],this.cachedVisibleStories={init:!1,data:{}},this.fireTimer=this.fireTimer.bind(this),this.logAnnotatedVPV=this.logAnnotatedVPV.bind(this),this.markStoryRead=this.markStoryRead.bind(this),this.behavior=a}s.prototype.init=function(a){__p&&__p();this.useBanzai=!0;this.vpvDebug=!!a.vpv_debug;this.vpvdDebug=!!a.vpvd_debug;this.vpvdAnalysis=!!a.vpvd_analysis;this.trackingHooks=!!a.tracking_hooks;this.ctaLoggingEnabled=!!a.cta_logging_enabled;this.adAllocationIntegrityLoggingEnabled=!!a.ad_allocation_integrity_logging_enabled;this.readStoryIDs={};this.annotatedStoryIDs={};this.minSizeToBeVisible=200;this.storyIDsWasInView={};this.minFractionToBeVisibleForTimetracking=.5;this.scrollThrottlingInterval=100;this.mouseThrottlingInterval=100;this.keyboardThrottlingInterval=100;this.userActivityPollingInterval=5e3;this.timeToBeConsideredInactive=15e3;this.minTimeToReportImmediately=500;this.discardVPVDIntervalThreshold=9e4;this.active_state_duration=1e3;this.height_diff_to_change_state=25;this.focused_state_duration=3500;this.invalidateAllStoriesCache();this.cachedViewportHeight=b("getViewportDimensions")().height;this.isTimetrackingEnabled=!1;this.activeStories={};this.userInactiveLock=!1;this.userActivityPollerTimeoutID=null;this._headLoadStoryCount=0;this.behavior.getDataFromConfig&&this.behavior.getDataFromConfig(a,this);this.isTimetrackingEnabled&&(this.lastMouseX=-1,this.lastMouseY=-1,this.lastStreamY=-1,this.latestStreamYChangedTimeStamp=-1,this.userFocus=p,this.latestUserFocus=p,this.latestUserActivity="init",this.focusedStory=null,this.latestFocusedStory=null,this.latestActiveStory=null,this.totalVPVDuration={});a.tracking_duration_config&&(this.scrollThrottlingInterval=a.tracking_duration_config.scroll_throttling_interval,this.mouseThrottlingInterval=a.tracking_duration_config.mouse_throttling_interval,this.keyboardThrottlingInterval=a.tracking_duration_config.keyboardThrottlingInterval,this.userActivityPollingInterval=a.tracking_duration_config.user_activity_polling_interval,this.timeToBeConsideredInactive=a.tracking_duration_config.time_to_be_considered_inactive,this.minFractionToBeVisibleForTimetracking=a.tracking_duration_config.min_fraction_to_be_visible,this.minTimeToReportImmediately=a.tracking_duration_config.min_time_to_report_immediately,this.active_state_duration=a.tracking_duration_config.active_state_duration,this.height_diff_to_change_state=a.tracking_duration_config.story_height_diff_to_change_state,this.focused_state_duration=a.tracking_duration_config.focused_state_duration,this.discardVPVDIntervalThreshold=a.tracking_duration_config.discard_vpvd_interval_threshold);a.record_delay!==void 0||h(0,1115);var c=b("debounce")(this.fireTimer,a.record_delay,this);this.initialStories=this.getStoriesInView();this.initialStoriesLogged=!1;this.annotatedVPVLogging&&this.initialStories.forEach(this.logAnnotatedVPV,this);this.subscriptions=new(b("SubscriptionsHandler"))();this.subscriptions.addSubscriptions(this._getScrollListener(c),b("Event").listen(window,"resize",function(){this.invalidateVisibleStoriesCache(),this.cachedViewportHeight=b("getViewportDimensions")().height,c()}.bind(this)),b("Event").listen(window,"focus",function(){this.isTimetrackingEnabled&&this.updateTimeTrackingData(!1,"window_focus")}.bind(this)),b("Event").listen(window,"blur",function(){this.isTimetrackingEnabled&&this.updateTimeTrackingData(!0,"window_blur")}.bind(this)),b("Arbiter").subscribe(b("NavigationMessage").NAVIGATION_BEGIN,this.cleanup.bind(this)),b("Arbiter").subscribe("Stream/totalHeadLoadedStories",function(a,b){this._headLoadStoryCount=b.count}.bind(this)),b("Arbiter").subscribe(b("LitestandMessages").STORIES_INSERTED,function(){if(!this.initialStoriesLogged){var a=this.getStoriesInView();a.forEach(this.logAnnotatedVPV,this)}else c();this.isTimetrackingEnabled&&this.updateTimeTrackingData(!1,"stories_inserted")}.bind(this)));if(this.isTimetrackingEnabled&&this.behavior.getStream){this.updateTimeTrackingData(!1,"init");a=b("throttle")(function(a){this.invalidateVisibleStoriesCache(),this.handleScroll(a)}.bind(this),this.scrollThrottlingInterval);var d=b("throttle")(function(a){return this.handleKeyboard(a)}.bind(this),this.keyboardThrottlingInterval),e=b("throttle")(function(a){return this.handleMouse(a)}.bind(this),this.mouseThrottlingInterval);this.subscriptions.addSubscriptions(b("Event").listen(window,"scroll",a),b("Event").listen(document.documentElement,"DOMMouseScroll",a,void 0,{passive:!0}),b("Event").listen(document.documentElement,"mousewheel",a,void 0,{passive:!0}),b("Event").listen(document.documentElement,"keydown",d),b("Event").listen(document.documentElement,"mouseover",e),b("Event").listen(document.documentElement,"mousemove",e),b("Event").listen(document.documentElement,"click",function(a){this.handleMouse(a)}.bind(this)),b("Arbiter").subscribe("Event/stop",function(a,b){this.handleMouse(b.event)}.bind(this)),b("Arbiter").subscribe("PhotoSnowlift.OPEN",function(){this.userFocus=q,this.handleLayers()}.bind(this)),b("Arbiter").subscribe("PhotoSnowlift.CLOSE",function(){this.userFocus=o,this.focusedStory=null,this.updateTimeTrackingData(!1,"snowlift_close")}.bind(this)));this._userActivityPoller()}b("Run").onLeave(this.cleanup.bind(this));b("Run").onUnload(this.cleanup.bind(this))};s.prototype._getScrollListener=function(a){return b("Event").listen(window,"scroll",a)};s.prototype.cleanup=function(){this.subscriptions&&(this.subscriptions.release(),this.subscriptions=null);this.isTimetrackingEnabled&&(b("clearTimeout")(this.userActivityPollerTimeoutID),this.updateTimeTrackingData(!0,"cleanup"));if(this.annotatedVPVLogging){var a=this.getStoriesInView();a.forEach(this.logAnnotatedVPV,this)}this.initialStories=[];this._headLoadStoryCount=0};s.prototype.fireTimer=function(){__p&&__p();this.initialStoriesLogged||(this.initialStories.forEach(this.markStoryRead,this),this.initialStoriesLogged=!0);this.storiesInView=this.getStoriesInView();this.storiesInView.forEach(this.markStoryRead,this);if(this.trackingHooks){var a=this.isTimetrackingEnabled?this.getVisibleStoriesFromCache():this.getAllStoriesInView(),c=[],d=Object.keys(a);for(var e=0,f=d.length;e<f;e++){var g=d[e];a[g].story&&c.push(a[g].story)}b("ViewportTrackingHooks").updateVisibleViewportObjects(c)}};s.prototype.getSessionID=function(){return null};s.prototype._userActivityPoller=function(){!this.userInactiveLock&&!b("UserActivity").isActive(this.timeToBeConsideredInactive)&&(this.userInactiveLock=!0,this.userFocus=p,this.updateTimeTrackingData(!1,"user_activity_inactive"),b("UserActivity").subscribeOnce(function(){this.userFocus=o,this.updateTimeTrackingData(!1,"user_activity_active"),this.userInactiveLock=!1}.bind(this))),this.userActivityPollerTimeoutID=b("setTimeout")(b("TimeSlice").guard(this._userActivityPoller.bind(this),"ViewportTracking poll setTimeout",{propagationType:b("TimeSlice").PropagationType.EXECUTION}),this.userActivityPollingInterval)};s.prototype.getQueryID=function(a){return-1};s.prototype.getFBFeedLocations=function(a){return-1};s.prototype.getFBFeedInsertionPosition=function(a){return-1};s.prototype.createVPVDTimer=function(a){var b=document.createElement("label");b.setAttribute("for",a.toString());b.setAttribute("class","vpvd_debug_timer");return b};s.prototype.updateVPVDTimer=function(a){__p&&__p();var c=this.activeStories[a].story;if(!c)return;var d=b("DOM").scry(c,".vpvd_debug_timer");if(!d.length){d=[this.createVPVDTimer(c),this.createVPVDTimer(c)];var e=b("DOM").scry(c,".UFIRow");e.length&&e[e.length-1].clientWidth>0?e[e.length-1].appendChild(d[0]):c.appendChild(d[0]);c.insertBefore(d[1],c.firstChild)}e=this.totalVPVDuration[a];c=Math.floor(e/1e3)+"."+Math.floor(e%1e3/100);b("DOM").setContent(d[0],c);b("DOM").setContent(d[1],c)};s.prototype.updateVPVDTimers=function(){for(var a in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,a)&&this.updateVPVDTimer(a)};s.prototype.logVpvdAnalysis=function(a,c,d,e,f,g){__p&&__p();var h=new(b("BanzaiScuba"))("vpv_duration");h.addDenorm("qid",this.getQueryID(this.activeStories[a].story));h.addDenorm("uid",b("CurrentUser").getID());h.addDenorm("vsid",a);h.addInteger("time",Math.round(Date.now()/1e3));h.addInteger("duration",e);h.addInteger("total_duration",f);h.addNormal("story_state",this.activeStories[a].state);h.addNormal("is_active_state",d);h.addNormal("num_visible_stories",this.numVisibleStories);h.addInteger("story_height",this.activeStories[a].story_height);h.addInteger("story_visible_height",this.activeStories[a].height);h.addInteger("state_visible_height",g);h.addInteger("total_visible_height",this.totalVisibleHeight);h.addInteger("total_height",this.totalHeight);h.addNormal("user_focus",this.latestUserFocus);h.addNormal("next_user_focus",this.userFocus);h.addInteger("vpvd",c);h.addInteger("accumulated_vpvd",this.activeStories[a].vpvd);h.addNormal("user_activity",this.latestUserActivity);h.addNormal("next_user_activity",this.userActivity);h.addInteger("story_position_y",this.activeStories[a].y);h.addInteger("feed_insertion_position",this.getFBFeedInsertionPosition(this.activeStories[a].story));h.addNormal("visible_position",this.activeStories[a].visible_position);h.addNormal("is_focused_story",this.activeStories[a].is_focused);h.post()};s.prototype.shouldDiscardStory=function(a){var b=this.activeStories[a].height||0;return b!=this.activeStories[a].story_height&&b<this.totalHeight/2};s.prototype.calculateTotalHeight=function(){this.totalHeight=0;for(var a in this.activeStories)Object.prototype.hasOwnProperty.call(this.activeStories,a)&&(this.totalHeight+=this.activeStories[a].height)};s.prototype.updateVPVDurations=function(a){__p&&__p();var b;if(this.latestUserFocus===p||a-this.latestTimeTrackingTimestamp>this.discardVPVDIntervalThreshold)return;b=(b={},b[m]=0,b[l]=0,b[k]=0,b);var c=a-this.latestTimeTrackingTimestamp>=this.focused_state_duration;this.totalVisibleHeight=0;for(var d in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,d)&&!(this.latestUserFocus===o&&c&&this.shouldDiscardStory(d))){var e=this.activeStories[d].state||null,f=this.activeStories[d].height||0;e!==null&&Object.prototype.hasOwnProperty.call(b,e)&&(b[e]+=f);this.totalVisibleHeight+=f}e=0;f=a-this.latestTimeTrackingTimestamp;this.latestUserFocus===o&&(f=b[k]>0?this.focused_state_duration:this.active_state_duration,f=Math.min(f,a-this.latestTimeTrackingTimestamp),e=a-this.latestTimeTrackingTimestamp-f);a=0;var g=k;for(var h=k;h>=m;h--)if(b[h]>0){a=b[h];g=h;break}h=b[k]+b[l]+b[m];b=0;for(d in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,d)){if(this.latestUserFocus===o&&c&&this.shouldDiscardStory(d))continue;var i=this.activeStories[d].state||n;if(a>0&&i>=g){i=this.activeStories[d].height||0;b=f*(i/a);this.vpvdAnalysis&&f>0&&this.logVpvdAnalysis(d,b,!0,f,f+e,a);this.activeStories[d].vpvd+=b;this.totalVPVDuration[d]+=b}if(h>0){i=this.activeStories[d].height||0;b=e*(i/h);this.vpvdAnalysis&&e>0&&this.logVpvdAnalysis(d,b,!1,e,f+e,h);this.activeStories[d].vpvd+=b;this.totalVPVDuration[d]+=b}}};s.prototype.updateActiveStory=function(a,b,c,d){this.activeStories[a].state=b,this.activeStories[a].ts=c,this.activeStories[a].height_snapshot=d[a].height,this.activeStories[a].is_focused=this.focusedStory===d[a].story,this.activeStories[a].story_height=d[a].story_height,this.vpvdAnalysis&&(this.activeStories[a].visible_position=d[a].visible_position,this.activeStories[a].y=d[a].y)};s.prototype.updateActiveStories=function(a,b){for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))if(c in this.activeStories){var d=a[c].height||0;this.activeStories[c].height=d;d=d-(this.activeStories[c].height_snapshot||0);this.focusedStory===a[c].story?this.updateActiveStory(c,k,b,a):d<=-this.height_diff_to_change_state?this.updateActiveStory(c,this.shouldDiscardStory(c)?n:m,b,a):(d>=this.height_diff_to_change_state||this.activeStories[c].is_focused||this.activeStories[c].height===this.activeStories[c].story_height)&&this.updateActiveStory(c,l,b,a)}else this.storyIDsWasInView[c]=!0,this.activeStories[c]={evp_ts:b,story:a[c].story,height:a[c].height,vpvd:0},this.totalVPVDuration[c]||(this.totalVPVDuration[c]=0),this.updateActiveStory(c,l,b,a),this.behavior.afterStoryEntersViewport&&this.behavior.afterStoryEntersViewport(this.activeStories[c].story)};s.prototype.recordVPVDurations=function(a,b){for(var c in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,c)&&(b||!(c in a))){var d=this.activeStories[c].vpvd||0;(d>this.focused_state_duration||d===this.totalVPVDuration[c])&&this.recordTimeStoryWasInView(this.activeStories[c]);this.behavior.afterStoryExitsViewport&&this.behavior.afterStoryExitsViewport(this.activeStories[c].story);delete this.activeStories[c]}};s.prototype.updateTimeTrackingData=function(a,b){__p&&__p();this.userActivity=b;this.activeStories||(this.activeStories={});b=Date.now();this.latestTimeTrackingTimestamp||(this.latestTimeTrackingTimestamp=b);var c=this.getVisibleStoriesFromCache();this.calculateTotalHeight();this.updateVPVDurations(b);this.updateActiveStories(c,b);this.vpvdDebug&&this.updateVPVDTimers();this.recordVPVDurations(c,a);a?this.latestTimeTrackingTimestamp=0:this.latestTimeTrackingTimestamp=b;this.latestUserActivity=this.userActivity;this.latestUserFocus=this.userFocus;this.focusedStory&&(this.latestActiveStory=this.focusedStory);this.latestFocusedStory=this.focusedStory;this.focusedStory=null};s.prototype.needsToUpdateTimeTrackingData=function(){return!(this.latestUserFocus===this.userFocus&&(this.userFocus===p||this.userFocus===o&&!this.latestFocusedStory&&!this.focusedStory))};s.prototype.getfocusedStory=function(a){var c=this.getVisibleStoriesFromCache();for(var d in c)if(Object.prototype.hasOwnProperty.call(c,d)){var e=c[d].story;if(e&&b("ViewportTrackingHelper").isDescendantOf(a,e))return e}return null};s.prototype.handleLayers=function(){if(this.userFocus===q||this.userFocus===r){this.focusedStory=this.latestActiveStory;this.updateTimeTrackingData(!1,"media_layer");return!0}return!1};s.prototype.didInteractWithStream=function(a){if(!this.behavior.getStream)return!1;var c=this.behavior.getStream();return b("ViewportTrackingHelper").isDescendantOf(a,c)||b("ViewportTrackingHelper").isDescendantOf(c,a)};s.prototype.handleScroll=function(a){if(this.handleLayers())return;var c=Date.now();this.behavior.getStream||h(0,1116);var d=b("getElementPosition")(this.behavior.getStream()).y;d!=this.lastStreamY||c-this.latestStreamYChangedTimeStamp<2.5*this.scrollThrottlingInterval||this.didInteractWithStream(a.target)?(this.latestStreamYChangedTimeStamp=c,this.userFocus=o):this.userFocus=p;this.lastStreamY=d;(this.userFocus===o||this.needsToUpdateTimeTrackingData())&&this.updateTimeTrackingData(!1,"scroll")};s.prototype.handleKeyboard=function(a){if(this.handleLayers())return;this.didInteractWithStream(a.target)?(this.userFocus=o,this.focusedStory=this.getfocusedStory(a.target)):b("CSS").hasClass(a.target,"shareInput")?(this.userFocus=o,this.focusedStory=this.latestActiveStory):this.userFocus=p;(this.userFocus===o||this.needsToUpdateTimeTrackingData())&&this.updateTimeTrackingData(!1,"keyboard")};s.prototype.handleMouse=function(a){if(this.handleLayers())return;if(a.type!="click"&&a.clientX===this.lastMouseX&&a.clientY===this.lastMouseY)return;a.type==="click"&&this.invalidateVisibleStoriesCache();this.didInteractWithStream(a.target)?(this.userFocus=o,this.focusedStory=this.getfocusedStory(a.target)):this.userFocus=p;this.lastMouseX=a.clientX;this.lastMouseY=a.clientY;this.needsToUpdateTimeTrackingData()&&this.updateTimeTrackingData(!1,a.type)};s.prototype.getStoriesInView=function(){__p&&__p();var a=this.behavior.getAllStories(),c=[],d=!1;for(var e=0;e<a.length;e++){var f=a[e],g=this.behavior.getStoryID(f);if(g&&this.hasBeenVisible(g))continue;if(b("ViewportTrackingHelper").isVisible(f,this.minSizeToBeVisible))f.getAttribute("data-insertion-position")===null&&f.setAttribute("data-insertion-position",(e-this._headLoadStoryCount).toString()),c.push(f),d=!0;else if(d)break}return c};s.prototype.getAllStoriesFromCache=function(){this.cachedAllStories.length===0&&(this.cachedAllStories=this.behavior.getAllStories());return this.cachedAllStories};s.prototype.invalidateAllStoriesCache=function(){this.cachedAllStories=[],this.invalidateVisibleStoriesCache()};s.prototype.getVisibleStoriesFromCache=function(){this.cachedVisibleStories.init||(this.cachedVisibleStories={init:!0,data:this.getAllStoriesInView()});return this.cachedVisibleStories.data};s.prototype.invalidateVisibleStoriesCache=function(){this.cachedVisibleStories={init:!1,data:{}}};s.prototype.getAllStoriesInView=function(){__p&&__p();var a=this.getAllStoriesFromCache(),c={},d=!1,e=0,f=a.length,g=1,h=a.length;this._indexOfLastVisibleStoryOnPreviousPass>f/2&&(e=f-1,f=-1,g=-g);for(var e=e;e!=f;e+=g){var i=a[e],j=b("ViewportTrackingHelper").getHeightIfVisible(i,Math.min(this.minSizeToBeVisible,this.minFractionToBeVisibleForTimetracking*b("DOMDimensions").getElementDimensions(i).height));if(j>0||i===this.focusedStory){i.getAttribute("data-insertion-position")===null&&i.setAttribute("data-insertion-position",(e-this._headLoadStoryCount).toString());var k=this.behavior.getStoryID(i);k&&(c[k]={story:i,height:j,story_height:b("DOMDimensions").getElementDimensions(i).height},d=!0,this.vpvdAnalysis&&(c[k].y=b("getElementPosition")(i).y,c[k].visible_position=e,h=Math.min(h,e)))}else if(d){this._indexOfLastVisibleStoryOnPreviousPass=e-g;break}}if(this.vpvdAnalysis){this.numVisibleStories=0;for(k in c)Object.prototype.hasOwnProperty.call(c,k)&&(c[k].visible_position-=h,this.numVisibleStories++)}return c};s.prototype.getTimetrackingDataToLog=function(a){a={evt:i,time_spent_id:b("pageID"),vpvd_start_timestamp:a.evp_ts||null,vpvd_time_delta:Math.round(a.vpvd||0),story_height:b("DOMDimensions").getElementDimensions(a.story).height,viewport_height:this.cachedViewportHeight};return{ft:a}};s.prototype.getGapsInfoToLog=function(a){__p&&__p();if(a===null||a===void 0)return null;var c=b("AdAllocationIntegrityUtils").getFeedStoryCategory(a),d=new(b("AdAllocationIntegrityGapsInfo"))(c);if(!b("AdAllocationIntegrityUtils").isGapRuleCategory(c))return d;else{c=b("AdAllocationIntegrityUtils").getDedupKey(a);if(c===null)return null;a=this.behavior.getAllStories().filter(function(a){return Object.prototype.hasOwnProperty.call(this.storyIDsWasInView,this.behavior.getStoryID(a))}.bind(this));var e=-1;for(var f=a.length-1;f>=0;f--){var g=b("AdAllocationIntegrityUtils").getDedupKey(a[f]);if(e<0)g!==null&&c===g&&(e=f,d.setDistToTop(e+1));else{g=b("AdAllocationIntegrityUtils").getFeedStoryCategory(a[f]);b("AdAllocationIntegrityUtils").isGapRuleCategory(g)&&d.setDistIfAbsent(g,e-f)}}return d}};s.prototype.recordTimeStoryWasInView=function(a){__p&&__p();if(!this.isTimetrackingEnabled)return;var c=a.story;if(!a.vpvd||!c)return;if(a.vpvd>0){a=this.getTimetrackingDataToLog(a);var d=b("collectDataAttributes")(c,["ft"]);Object.assign(a.ft,d.ft);if(this.adAllocationIntegrityLoggingEnabled){var e=this.getGapsInfoToLog(c);Object.assign(a.ft,e)}e=!!d.ft.ei&&a.ft.vpvd_time_delta>this.minTimeToReportImmediately;a.ei&&delete a.ei;this.sendDataToLog(c,a,e)}};s.prototype.hasBeenVisible=function(a){return a in this.readStoryIDs};s.prototype.sendDataToLog=function(a,c,d){if(this.useBanzai){var e={};d&&(e.delay=3e3);d=this.getSessionID();d&&(c.ft.session_id=d);c.ft.raw_client_time=Date.now()/1e3;b("Banzai").post("feed_tracking",c,e)}else b("clickRefAction")(j,a,null,"FORCE",c)};s.prototype.markStoryRead=function(a){__p&&__p();var c=this.behavior.getStoryID(a);if(!c||this.hasBeenVisible(c))return;this.readStoryIDs[c]=!0;this.annotatedStoryIDs[c]=!0;c=this._getDataToLogImpl(a);var d=b("collectDataAttributes")(a,["ft"]);Object.assign(c.ft,d.ft);delete c.ei;this.sendDataToLog(a,c,!1);this.vpvDebug&&b("CSS").addClass(a,"_5m7s")};s.prototype.logAnnotatedVPV=function(a){__p&&__p();var c=this.behavior.getStoryID(a);if(!c||c in this.annotatedStoryIDs)return;this.annotatedStoryIDs[c]=!0;c=this._getDataToLogImpl(a);var d=b("collectDataAttributes")(a,["ft"]);Object.assign(c.ft,d.ft);delete c.ei;c.ft.vpv_ft_only=1;this.sendDataToLog(a,c,!1)};s.prototype._getDataToLogImpl=function(a){a=this.behavior.getDataToLog(a);a.ft||(a.ft={});return a};s.clearSingleton=function(){};var t={getAllStories:function(){return[]},getStoryID:function(a){return null},getDataToLog:function(a){return{}}};a=b("viewportTrackingBuilder")(function(a){return new s(t)});s.factory=a.factory.bind(a);s.singleton=a.singleton.bind(a);s.clearSingleton=a.clearSingleton.bind(a);s.getBehavior=function(){return t};e.exports=s}),null);
__d("PrivacySelectorEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPEN_MENU:"open_menu",CLOSE_MENU:"close_menu",MORE_OPTIONS:"more_options",MORE:"more",SEE_ALL:"see_all",CUSTOM_SAVE:"custom_save",CUSTOM_CANCEL:"custom_cancel",SELECT_CUSTOM:"select_custom",SPECIFIC_FRIENDS_SAVE:"specific_friends_save",SPECIFIC_FRIENDS_CANCEL:"specific_friends_cancel",SELECT_SPECIFIC_FRIENDS:"select_specific_friends",FRIENDS_EXCEPT_SAVE:"friends_except_save",FRIENDS_EXCEPT_CANCEL:"friends_except_cancel",SELECT_FRIENDS_EXCEPT:"select_friends_except",SELECT_EVERYONE:"select_everyone",SELECT_FRIENDS_OF_FRIENDS:"select_friends_of_friends",SELECT_FRIENDS:"select_friends",SELECT_FRIENDS_EXCEPT_ACQUIANTANCES:"select_friends_except_acquaintances",SELECT_ONLY_ME:"select_only_me",SELECT_FB_ONLY:"select_fb_only",SELECT_FRIENDLIST:"select_friendlist",SELECT_OTHER:"select_other"})}),null);
__d("PrivacySelectorSelectableItem",["csx","cx","CSS","DOM","DOMQuery","MenuSelectableItem","React"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j="._o00",k="._o01",l="._po2";c=babelHelpers.inherits(a,b("MenuSelectableItem"));i=c&&c.prototype;function a(a){"use strict";if(a.icon){var c="_392n _1rwt";a.children?a.icon=b("React").createElement("div",{className:c},a.icon):a.icon=b("DOM").create("div",{className:c},a.icon)}i.constructor.call(this,a)}a.prototype.render=function(){"use strict";var a=i.render.call(this),c=b("DOMQuery").find(a,"._54nh");b("CSS").addClass(c,"_4chm");c=c.parentNode;b("CSS").addClass(c,"_4chl");var d=b("DOMQuery").scry(a,"._392n")[0];d||b("CSS").addClass(c,"_4857");return a};a.prototype.isMoreButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),j)};a.prototype.isMoreOptionsButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),l)};a.prototype.isSeeAllButton=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),k)};e.exports=a}),null);
__d("PrivacySelectorOptionNew",["csx","cx","fbt","CSS","DOM","DOMQuery","JSXDOM","PrivacyConst","PrivacySelectorEvent","PrivacySelectorSelectableItem"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j;c=babelHelpers.inherits(a,b("PrivacySelectorSelectableItem"));j=c&&c.prototype;function a(a){"use strict";j.constructor.call(this,a),this._origLabel=this.getLabel(),this._origTriggerLabel=this.getTriggerLabel()}a.prototype._getData=function(){"use strict";return this._data};a.prototype.getTooltip=function(){"use strict";return this._getData().tooltip};a.prototype.getPostParam=function(){"use strict";return this._getData().postParam.toString()};a.prototype.setPostParam=function(a){"use strict";this._getData().postParam=a;return this};a.prototype.getSubtitles=function(){"use strict";return this._data.optionSubtitles};a.prototype.setSubtitles=function(a){"use strict";this._data.optionSubtitles!=null&&(this._data.optionSubtitles=a);return this};a.prototype.getTriggerIcon=function(){"use strict";return this._getData().triggerIcon};a.prototype.getTriggerLabel=function(){"use strict";return this._getData().triggerLabel};a.prototype.getIconType=function(){"use strict";return this._getData().iconType};a.prototype.isPublic=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.EVERYONE.toString()};a.prototype.isFriendsOfFriends=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS_OF_FRIENDS.toString()};a.prototype.isFriends=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS.toString()};a.prototype.isFriendsExceptAcquaintances=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FRIENDS_MINUS_ACQUAINTANCES.toString()};a.prototype.isOnlyMe=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.ONLY_ME.toString()};a.prototype.isFBOnly=function(){"use strict";return this.getPostParam()===b("PrivacyConst").PostParam.FB_ONLY.toString()};a.prototype.isFriendlist=function(){"use strict";return this._data.isFriendlist};a.prototype.isBasicOption=function(){"use strict";return!0};a.prototype.isCustomOption=function(){"use strict";return!1};a.prototype.isSavedCustomOption=function(){"use strict";return!1};a.prototype.isPrivateSharingDisabledOption=function(){"use strict";return!1};a.prototype.getSavedCustomPrivacyType=function(){"use strict";return null};a.prototype.getTagExpansionBehavior=function(){"use strict";return this._getData().tagExpansionBehavior};a.prototype.getBaseValue=function(){"use strict";return this._getData().baseValue};a.prototype.getIndex=function(){"use strict";return this._getData().value};a.prototype.getLoggingEventName=function(){"use strict";__p&&__p();if(this.isPublic())return b("PrivacySelectorEvent").SELECT_EVERYONE;else if(this.isFriendsOfFriends())return b("PrivacySelectorEvent").SELECT_FRIENDS_OF_FRIENDS;else if(this.isFriends())return b("PrivacySelectorEvent").SELECT_FRIENDS;else if(this.isFriendsExceptAcquaintances())return b("PrivacySelectorEvent").SELECT_FRIENDS_EXCEPT_ACQUIANTANCES;else if(this.isOnlyMe())return b("PrivacySelectorEvent").SELECT_ONLY_ME;else if(this.isFBOnly())return b("PrivacySelectorEvent").SELECT_FB_ONLY;else if(this.isFriendlist())return b("PrivacySelectorEvent").SELECT_FRIENDLIST;else return b("PrivacySelectorEvent").SELECT_OTHER};a.prototype.updateAfterTagExpansion=function(a,b){"use strict";var c=this._origLabel,d=this._origTriggerLabel;a&&this._getData().showPlusOnTagExpansion&&(c=i._("{privacyLabel} (+)",[i._param("privacyLabel",c)]),b&&this.isFriends()?d=i._("Friends, Friends of Tagged"):d=i._("{privacyLabel} (+)",[i._param("privacyLabel",d)]));this._setLabel(c);this._getData().triggerLabel=d;b=this._getExpansionType(a);c=this._getData().optionSubtitles||{};this._setSubtitle(c[b])};a.prototype.isBelowSoftFold=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),"._4mwj")};a.prototype.isBelowFold=function(){"use strict";return b("CSS").matchesSelector(this.getRoot(),"._3ey_")};a.prototype.removeOnBootload=function(){"use strict";return!!this._getData().removeOnBootload};a.prototype._setLabel=function(a){"use strict";if(!a)return;var c=b("DOMQuery").find(this.getRoot(),"._54nh");c&&b("DOM").setContent(c,a);this._getData().label=a};a.prototype._setSubtitle=function(a){"use strict";if(!a)return;var c=b("DOMQuery").scry(this.getRoot(),"._48u1");c&&c[0]&&b("DOM").setContent(c[0],a)};a.prototype._getExpansionType=function(a){"use strict";return a?b("PrivacyConst").ExpansionType.TAGS_ONLY:b("PrivacyConst").ExpansionType.NONE};a.prototype.render=function(){"use strict";__p&&__p();var a=j.render.call(this);if(!this._getData().isPrimaryOption)return a;var c=b("DOMQuery").find(a,"._54nc");c&&b("CSS").addClass(c,"_48t_");var d=b("DOMQuery").scry(a,"._392n")[0];!d&&c&&b("CSS").addClass(c,"_4zfs");d=b("DOM").find(a,"._54nh");d&&b("CSS").addClass(d,"_48u0");d=b("JSXDOM").div({className:"_48u1"},this._getData().optionSubtitle);b("DOM").appendContent(c,d);return a};e.exports=a}),null);
__d("SavedCustomPrivacyType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SPECIFIC_FRIENDS:"specific_friends",FRIENDS_EXCEPT:"friends_except"})}),null);
__d("XPrivacySpecificAudienceSelectorDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/specific_audience_selector_dialog/",{autosave:{type:"Bool",defaultValue:!1},content_type:{type:"String"},fbid:{type:"String",required:!0},option_id:{type:"String"},post_param:{type:"String"},privacy_type:{type:"Enum",required:!0,enumType:1},render_location:{type:"Enum",required:!0,enumType:1},return_uri:{type:"String"},cancel_uri:{type:"String"}})}),null);
__d("PrivacySelectorSavedCustomOption",["AsyncDialog","AsyncRequest","DataStore","PrivacySelectorEvent","PrivacySelectorOptionNew","SavedCustomPrivacyType","XPrivacySpecificAudienceSelectorDialogController"],(function(a,b,c,d,e,f){__p&&__p();var g;a=babelHelpers.inherits(h,b("PrivacySelectorOptionNew"));g=a&&a.prototype;function h(a){"use strict";g.constructor.call(this,a)}h.prototype.getSelector=function(){"use strict";return this._selector};h.prototype.isBasicOption=function(){"use strict";return!1};h.prototype.isSavedCustomOption=function(){"use strict";return!0};h.prototype.getSavedCustomPrivacyType=function(){"use strict";return this._data.savedCustomPrivacyType};h.prototype.getLoggingEventName=function(){"use strict";switch(this._data.savedCustomPrivacyType){case b("SavedCustomPrivacyType").FRIENDS_EXCEPT:return b("PrivacySelectorEvent").SELECT_FRIENDS_EXCEPT;case b("SavedCustomPrivacyType").SPECIFIC_FRIENDS:return b("PrivacySelectorEvent").SELECT_SPECIFIC_FRIENDS;default:return b("PrivacySelectorEvent").SELECT_OTHER}};h.prototype.openDialog=function(a){"use strict";this._selector=a;b("DataStore").set(this._data.id,"PrivacySelectorCustomOption",this);var c=b("XPrivacySpecificAudienceSelectorDialogController").getURIBuilder().setBool("autosave",this._data.autosave).setString("content_type",a.getContentType()).setString("fbid",this._data.privacyFBID).setString("option_id",this._data.id).setString("post_param",this.getPostParam()).setEnum("privacy_type",this._data.savedCustomPrivacyType).setEnum("render_location",a.getRenderLocation()).getURI();c=new(b("AsyncRequest"))().setURI(c).setRelativeTo(a.getTriggerButtonElement());b("AsyncDialog").send(c)};h.informSave=function(a){"use strict";a=b("DataStore").get(a,"PrivacySelectorCustomOption");if(a instanceof h){a=a.getSelector();a&&a.animateSavedCustomSave()}};e.exports=h}),null);
__d("TimelineViewportTrackingLogType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IMPRESSION:"impression",DURATION:"duration"})}),null);
__d("XPrivacySelectorLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/selector/log/",{event:{type:"Enum",required:!0,enumType:1},render_location:{type:"Enum",required:!0,enumType:1},content_type:{type:"String",required:!0},privacy_fbid:{type:"String"},saved_custom_opt_in:{type:"Bool",defaultValue:!1}})}),null);